<Window x:Class="TS6_SpeakerOverlay.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:TS6_SpeakerOverlay.ViewModels"
        mc:Ignorable="d"
        Title="TS6 Overlay" Height="450" Width="300"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="NoResize">

    <!-- 绑定 ViewModel -->
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>


    <Grid>
        <!-- 背景层：解锁时显示微弱黑色，锁定(穿透)时全透明 -->
        <Border Background="#01000000" CornerRadius="10">

            <!-- 用户列表 -->
            <ItemsControl ItemsSource="{Binding Users}" Margin="10">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border x:Name="UserCard" 
                                Background="#99000000" 
                                CornerRadius="5" 
                                Margin="0,2" 
                                Padding="10,5"
                                HorizontalAlignment="Left">
                            <StackPanel Orientation="Horizontal">
                                <!-- 状态指示灯 -->
                                <Ellipse x:Name="StatusLight" Width="10" Height="10" Fill="Gray" Margin="0,0,8,0"/>
                                <!-- 名字 -->
                                <TextBlock Text="{Binding Name}" 
                                           Foreground="White" 
                                           FontSize="14" 
                                           FontWeight="Bold"
                                           FontFamily="Segoe UI"/>
                            </StackPanel>
                        </Border>

                        <DataTemplate.Triggers>
                            <!-- 说话状态：高亮 -->
                            <DataTrigger Binding="{Binding IsTalking}" Value="True">
                                <Setter TargetName="UserCard" Property="BorderThickness" Value="2"/>
                                <Setter TargetName="UserCard" Property="BorderBrush" Value="#4FCD8E"/>
                                <Setter TargetName="StatusLight" Property="Fill" Value="#4FCD8E"/>
                            </DataTrigger>
                            
                            <!-- 没说话：半透明 -->
                            <DataTrigger Binding="{Binding IsTalking}" Value="False">
                                <Setter TargetName="UserCard" Property="Opacity" Value="0.5"/>
                            </DataTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>

        <!-- 提示文本 -->
        <Border VerticalAlignment="Bottom" HorizontalAlignment="Center" 
                Background="#AA000000" CornerRadius="5" Padding="5" Margin="10">
            <Border.Style>
                <Style TargetType="Border">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsOverlayLocked}" Value="False">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
            <TextBlock Text="[解锁模式] 拖拽调整位置 | 按 Ctrl+L 锁定并穿透" Foreground="#FFAB53"/>
        </Border>
    </Grid>
</Window>